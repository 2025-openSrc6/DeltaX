# NFT Shop 구현 Walkthrough

## 1. 개요

DeltaX 프로젝트의 NFT Shop 기능을 구현했습니다. 사용자는 상점에서 닉네임 변경권, 컬러, 부스트, NFT 등을 구매할 수 있으며, 구매 시 즉시 효과가 적용됩니다.

## 2. 주요 기능

- **상점 페이지 (`/shop`)**: 카테고리별(NFT, 닉네임, 컬러 등) 아이템 목록 조회.
- **아이템 정렬**: NFT는 등급(Tier) 순서대로, 기타 아이템은 가격순으로 정렬.
- **아이템 구매**:
  - **닉네임 변경**: 구매 즉시 유저 닉네임 변경.
  - **닉네임 컬러**: 구매 즉시 유저 닉네임 색상 변경 (Metadata 활용).
  - **부스트**: 구매 시 부스트 시간 24시간 연장.
  - **Green Mushroom**: 구매 시 보유 수량 증가.
  - **NFT**: 구매 시 Sui 블록체인 상에서 NFT 민팅 (Pinata 이미지 연동).

## 3. 변경된 파일

- `app/api/nfts/shop/route.ts`: 아이템 목록 조회 API (카테고리 그룹화 및 정렬 로직 추가).
- `app/api/nfts/purchase/route.ts`: 아이템 구매 API (아이템별 효과 적용 로직 구현).
- `app/shop/page.tsx`: 상점 UI (API 연동 및 정렬된 데이터 표시).
- `lib/db.ts`: 로컬 개발 환경 DB 연결 설정 수정 (better-sqlite3 폴백 추가).
- `scripts/seed-shop-items.ts`: 초기 아이템 데이터 시딩 스크립트 (로컬 이미지 경로 및 Metadata 적용).

## 4. 실행 방법

로컬 개발 환경에서 상점 기능을 확인하려면 다음 절차를 따르세요.

1. **DB 시딩 (최초 1회)**

   ```bash
   npx tsx scripts/seed-shop-items.ts
   ```

   _이미 완료되었습니다._

2. **개발 서버 재시작 (필수)**
   DB 연결 설정 변경(`lib/db.ts`)을 적용하기 위해 서버를 재시작해야 합니다.
   - 터미널에서 `Ctrl+C`로 현재 서버 종료.
   - 다시 시작:
     ```bash
     npm run dev
     ```

3. **확인**
   - 브라우저에서 `http://localhost:3000/shop` 접속.
   - 아이템 목록이 보이고, NFT 탭에서 등급순으로 정렬되어 있는지 확인.

## 5. 트러블슈팅

- **아이템이 보이지 않아요**: 서버를 재시작했는지 확인하세요. `lib/db.ts` 수정 사항은 서버 재시작 후에 반영됩니다.
- **이미지가 깨져요**: 브라우저 캐시를 비우거나 강력 새로고침(`Ctrl+Shift+R`)을 해보세요.
